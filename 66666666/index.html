<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>測試用選單頁面</title><style>body{overflow-x:hidden;margin:0;padding:0;background:url('https://www.toptal.com/designers/subtlepatterns/uploads/double-bubble-outline.png')repeat}.game-container{width:100%;text-align:center;position:relative;padding:20px}iframe{display:block;margin:auto;position:relative;top:110px;left:-20px;max-width:100%}#login-container{position:fixed;top:10px;right:10px;z-index:10000}#login-button{padding:10px 20px;font-size:16px;cursor:pointer;background:rgba(0,0,0,0.7);color:#fff;border:none;border-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,0.5);transition:background 0.3s ease,transform 0.3s ease}#login-button:hover{background:rgba(0,0,0,0.85);transform:scale(1.05)}#online-users-container{position:fixed;top:10px;right:10px;background-color:rgba(0,0,0,0.7);color:#fff;padding:10px;border-radius:5px;z-index:9999;display:none}</style></head><body><script type="module">import{initializeApp}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";import{getAuth,signInWithPopup,GoogleAuthProvider,onAuthStateChanged,signOut}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";import{getDatabase,ref,push,onChildAdded}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";const firebaseConfig={apiKey:"AIzaSyDt9mJRH-BHlEksl4xla32sVIUGVnLUxWY",authDomain:"future-infusion-368721.firebaseapp.com",databaseURL:"https://future-infusion-368721-default-rtdb.firebaseio.com",projectId:"future-infusion-368721",storageBucket:"future-infusion-368721.firebasestorage.app",messagingSenderId:"345445420847",appId:"1:345445420847:web:070778c173ec6157c6dbda"};const app=initializeApp(firebaseConfig),auth=getAuth(app),database=getDatabase(app);const chatContainer=document.createElement("div");chatContainer.id="firebase-chat-container";chatContainer.style.position="fixed";chatContainer.style.bottom="20px";chatContainer.style.right="20px";chatContainer.style.width="300px";chatContainer.style.height="400px";chatContainer.style.background="rgba(0,0,0,0.8)";chatContainer.style.border="1px solid #ccc";chatContainer.style.borderRadius="5px";chatContainer.style.boxShadow="0 2px 10px rgba(0,0,0,0.1)";chatContainer.style.display="flex";chatContainer.style.flexDirection="column";document.body.appendChild(chatContainer);const chatHeader=document.createElement("div");chatHeader.style.background="transparent";chatHeader.style.color="white";chatHeader.style.padding="10px";chatHeader.style.textAlign="center";chatHeader.style.position="relative";chatHeader.textContent="聊天室";const enlargeButton=document.createElement("button");enlargeButton.textContent="放大";enlargeButton.style.position="absolute";enlargeButton.style.right="10px";enlargeButton.style.top="10px";enlargeButton.style.background="transparent";enlargeButton.style.border="none";enlargeButton.style.color="white";enlargeButton.style.fontSize="14px";enlargeButton.style.cursor="pointer";chatHeader.appendChild(enlargeButton);chatContainer.appendChild(chatHeader);const chatMessages=document.createElement("div");chatMessages.style.flex="1";chatMessages.style.overflowY="auto";chatMessages.style.overflowX="hidden";chatMessages.style.wordWrap="break-word";chatMessages.style.whiteSpace="normal";chatMessages.style.padding="10px";chatMessages.style.background="rgba(0,0,0,0.6)";chatMessages.style.color="white";chatContainer.appendChild(chatMessages);const chatInputContainer=document.createElement("div");chatInputContainer.style.display="flex";chatInputContainer.style.borderTop="1px solid #ccc";const chatInput=document.createElement("input");chatInput.type="text";chatInput.style.flex="1";chatInput.style.padding="10px";chatInput.style.background="#333";chatInput.style.color="white";chatInput.style.border="none";const sendButton=document.createElement("button");sendButton.textContent="發送";sendButton.style.padding="10px";sendButton.style.background="#007bff";sendButton.style.color="white";sendButton.style.border="none";sendButton.style.cursor="pointer";chatInputContainer.appendChild(chatInput);chatInputContainer.appendChild(sendButton);chatContainer.appendChild(chatInputContainer);let isEnlarged=false;enlargeButton.addEventListener("click",()=>{if(!isEnlarged){chatContainer.style.width="800px";chatContainer.style.height="700px";chatContainer.style.top="50%";chatContainer.style.left="50%";chatContainer.style.transform="translate(-50%,-50%)";chatContainer.style.bottom="";chatContainer.style.right="";enlargeButton.textContent="關閉"}else{chatContainer.style.width="300px";chatContainer.style.height="400px";chatContainer.style.bottom="20px";chatContainer.style.right="20px";chatContainer.style.top="";chatContainer.style.left="";chatContainer.style.transform="";enlargeButton.textContent="放大"}isEnlarged=!isEnlarged});function sendMessage(user,text){const messagesRef=ref(database,"messages");push(messagesRef,{text:text,name:user.displayName,avatar:user.photoURL,timestamp:Date.now()})}function appendMessage(msg){const msgDiv=document.createElement("div");msgDiv.style.marginBottom="10px";msgDiv.style.color="white";const avatarImg=document.createElement("img");avatarImg.src=msg.avatar||"";avatarImg.style.width="20px";avatarImg.style.height="20px";avatarImg.style.borderRadius="50%";avatarImg.style.marginRight="5px";const nameSpan=document.createElement("strong");nameSpan.textContent=msg.name||"匿名";const textSpan=document.createElement("span");textSpan.textContent=": "+msg.text;msgDiv.appendChild(avatarImg);msgDiv.appendChild(nameSpan);msgDiv.appendChild(textSpan);chatMessages.appendChild(msgDiv);chatMessages.scrollTop=chatMessages.scrollHeight}onAuthStateChanged(auth,user=>{chatMessages.innerHTML="";if(user){loadMessages();sendButton.onclick=()=>{if(chatInput.value.trim()!==""){sendMessage(user,chatInput.value);chatInput.value=""}}}else{const loginButton=document.createElement("button");loginButton.textContent="使用 Google 登入";loginButton.style.padding="10px";loginButton.style.background="#007bff";loginButton.style.color="white";loginButton.style.border="none";loginButton.style.cursor="pointer";loginButton.onclick=()=>{const provider=new GoogleAuthProvider();signInWithPopup(auth,provider).catch(console.error)};chatMessages.appendChild(loginButton)}});function loadMessages(){const messagesRef=ref(database,"messages");onChildAdded(messagesRef,snapshot=>{const msg=snapshot.val();appendMessage(msg)})}</script><script src="dynamicMenu.js"></script><div id="login-container"><button id="login-button">登入</button></div><div id="online-users-container"></div><div class="game-container"><iframe frameborder="0"src="https://itch.io/embed-upload/12865093?color=333333"allowfullscreen width="1000"height="700"></iframe></div><script type="module">import{initializeApp}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";import{getAnalytics}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics.js";import{getAuth,signInWithPopup,GoogleAuthProvider,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";import{getDatabase,ref,set,onDisconnect,onValue}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";const firebaseConfig={apiKey:"AIzaSyDt9mJRH-BHlEksl4xla32sVIUGVnLUxWY",authDomain:"future-infusion-368721.firebaseapp.com",databaseURL:"https://future-infusion-368721-default-rtdb.firebaseio.com",projectId:"future-infusion-368721",storageBucket:"future-infusion-368721.firebasestorage.app",messagingSenderId:"345445420847",appId:"1:345445420847:web:070778c173ec6157c6dbda",measurementId:"G-57PJMMNNWW"};const app=initializeApp(firebaseConfig),analytics=getAnalytics(app),auth=getAuth(),database=getDatabase(app),loginContainer=document.getElementById("login-container"),loginButton=document.getElementById("login-button"),onlineUsersContainer=document.getElementById("online-users-container");function updateUsersUI(users){onlineUsersContainer.innerHTML="";const countDiv=document.createElement("div");countDiv.textContent=`在線人數：${users.length}`;countDiv.style.fontWeight="bold";countDiv.style.marginBottom="5px";onlineUsersContainer.appendChild(countDiv);users.forEach(user=>{const userDiv=document.createElement("div");userDiv.style.display="flex";userDiv.style.alignItems="center";userDiv.style.marginBottom="5px";const avatar=document.createElement("img");avatar.src=user.photoURL;avatar.alt=user.displayName;avatar.style.width="30px";avatar.style.height="30px";avatar.style.borderRadius="50%";avatar.style.marginRight="8px";const nameSpan=document.createElement("span");nameSpan.textContent=user.displayName;userDiv.appendChild(avatar);userDiv.appendChild(nameSpan);onlineUsersContainer.appendChild(userDiv)})}function setUserOnline(user){const userStatusRef=ref(database,"onlineUsers/"+user.uid);set(userStatusRef,{uid:user.uid,displayName:user.displayName,photoURL:user.photoURL,lastActive:Date.now()}),onDisconnect(userStatusRef).remove()}function fetchAndDisplayOnlineUsers(currentUser){const onlineUsersRef=ref(database,"onlineUsers/");onValue(onlineUsersRef,snapshot=>{const onlineUsers=snapshot.val()||{},usersArray=Object.values(onlineUsers);usersArray.sort((a,b)=>{if(a.uid===currentUser.uid)return-1;if(b.uid===currentUser.uid)return1;return0});updateUsersUI(usersArray)})}loginButton.addEventListener("click",()=>{signInWithPopup(auth,new GoogleAuthProvider()).then(result=>{}).catch(error=>{console.error("Google 登入錯誤：",error),alert("Google 登入錯誤，請稍後再試。")})});onAuthStateChanged(auth,user=>{if(user){loginContainer.style.display="none",onlineUsersContainer.style.display="block",setUserOnline(user),fetchAndDisplayOnlineUsers(user)}else{loginContainer.style.display="block",onlineUsersContainer.style.display="none"}});</script></body></html>